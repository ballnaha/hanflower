generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Category {
  id          String    @id @default(uuid())
  name        String?
  title       String
  subtitle    String?
  slug        String    @unique(map: "category_slug_unique")
  description String?   @db.Text
  image       String?
  isActive    Boolean   @default(true)
  priority    Int       @default(0)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt
  products     Product[]

  @@map("category")
}

model Product {
  id                     String                   @id @default(uuid())
  title                  String
  slug                   String                   @unique(map: "Product_slug_key")
  type                   String
  price                  Decimal                  @db.Decimal(10, 2)
  originalPrice          Decimal?                 @db.Decimal(10, 2)
  discount               Int?
  description            String                   @db.Text
  image                  String
  stock                  Int                      @default(0)
  priority               Int                      @default(0)
  createdAt              DateTime                 @default(now())
  updatedAt              DateTime                 @updatedAt
  sku                    String                   @unique(map: "Product_sku_key")
  categoryId             String?
  discountVelvet         Int?
  hasQrCode              Boolean                  @default(true)
  isBestSeller           Boolean                  @default(false)
  isNew                  Boolean                  @default(false)
  originalPriceVelvet    Decimal?                 @db.Decimal(10, 2)
  priceVelvet            Decimal?                 @db.Decimal(10, 2)
  qrCodePrice            Decimal?                 @default(150.00) @db.Decimal(10, 2)
  stockVelvet            Int                      @default(0)
  valentinecardtoproduct ValentineCardToProduct[]
  orderitems              OrderItem[]
  category               Category?                @relation(fields: [categoryId], references: [id], map: "Product_categoryId_fkey")
  productdetails          ProductDetail[]
  productfeatures         ProductFeature[]
  productimages           ProductImage[]
  productshippings        ProductShipping[]

  @@index([categoryId], map: "Product_categoryId_fkey")
  @@map("product")
}

model ProductDetail {
  id        String  @id @default(uuid())
  text      String
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade, map: "ProductDetail_productId_fkey")

  @@index([productId], map: "ProductDetail_productId_fkey")
  @@map("productdetail")
}

model ProductFeature {
  id        String  @id @default(uuid())
  text      String
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade, map: "ProductFeature_productId_fkey")

  @@index([productId], map: "ProductFeature_productId_fkey")
  @@map("productfeature")
}

model ProductImage {
  id        String  @id @default(uuid())
  url       String
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade, map: "ProductImage_productId_fkey")

  @@index([productId], map: "ProductImage_productId_fkey")
  @@map("productimage")
}

model ProductShipping {
  id        String  @id @default(uuid())
  text      String
  productId String
  product   Product @relation(fields: [productId], references: [id], onDelete: Cascade, map: "ProductShipping_productId_fkey")

  @@index([productId], map: "ProductShipping_productId_fkey")
  @@map("productshipping")
}

model Order {
  id              String      @id @default(uuid())
  orderNumber     String      @unique(map: "Order_orderNumber_key")
  customerName    String
  customerEmail   String
  customerPhone   String
  customerAddress String      @db.Text
  totalAmount     Decimal     @db.Decimal(10, 2)
  status          String      @default("pending")
  paymentStatus   String      @default("unpaid")
  paymentMethod   String?
  shippingMethod  String?
  shippingFee     Decimal     @default(0.00) @db.Decimal(10, 2)
  notes           String?     @db.Text
  createdAt       DateTime    @default(now())
  updatedAt       DateTime    @updatedAt
  items           OrderItem[]

  @@map("order")
}

model OrderItem {
  id        String  @id @default(uuid())
  orderId   String
  productId String
  quantity  Int
  price     Decimal @db.Decimal(10, 2)
  order     Order   @relation(fields: [orderId], references: [id], onDelete: Cascade, map: "OrderItem_orderId_fkey")
  product   Product @relation(fields: [productId], references: [id], map: "OrderItem_productId_fkey")

  @@index([orderId], map: "OrderItem_orderId_fkey")
  @@index([productId], map: "OrderItem_productId_fkey")
  @@map("orderitem")
}

model User {
  id        String   @id @default(uuid())
  password  String
  role      String   @default("user")
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  email     String?  @unique(map: "User_email_key")
  name      String?
  username  String   @unique

  @@map("user")
}

model Setting {
  key         String   @id
  value       String   @db.Text
  description String?
  updatedAt   DateTime @updatedAt

  @@map("setting")
}

model Coupon {
  id          String    @id @default(cuid())
  code        String    @unique
  discount    Float
  type        String    @default("fixed")
  minSpend    Float     @default(0)
  maxDiscount Float?
  limit       Int?
  expireAt    DateTime?
  isActive    Boolean   @default(true)
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@map("coupon")
}

model ShippingMethod {
  id            String   @id @default(cuid())
  code          String   @unique
  name          String
  description   String?  @db.Text
  price         Decimal  @db.Decimal(10, 2)
  estimatedDays String?
  enabled       Boolean  @default(true)
  priority      Int      @default(0)
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("shippingmethod")
}

model ValentineCardToProduct {
  A             String
  B             String
  valentineCard ValentineCard @relation(fields: [A], references: [id], onDelete: Cascade, map: "_ValentineCardToproduct_A_fkey")
  product       Product       @relation(fields: [B], references: [id], onDelete: Cascade, map: "_ValentineCardToproduct_B_fkey")

  @@unique([A, B], map: "_ValentineCardToproduct_AB_unique")
  @@index([B], map: "_ValentineCardToproduct_B_index")
  @@map("_valentinecardtoproduct")
}

model EventAlbum {
  id          String       @id @default(uuid())
  title       String
  category    String?
  location    String?
  date        String?
  coverImage  String
  imagesCount Int          @default(0)
  isActive    Boolean      @default(true)
  priority    Int          @default(0)
  createdAt   DateTime     @default(now())
  updatedAt   DateTime     @updatedAt
  eventphotos EventPhoto[]

  @@map("eventalbum")
}

model EventPhoto {
  id         String     @id @default(uuid())
  albumId    String
  url        String
  caption    String?
  order      Int        @default(0)
  createdAt  DateTime   @default(now())
  eventalbum EventAlbum @relation(fields: [albumId], references: [id], onDelete: Cascade, map: "EventPhoto_albumId_fkey")

  @@index([albumId], map: "EventPhoto_albumId_fkey")
  @@map("eventphoto")
}

model ValentineCard {
  id                       String                   @id @default(uuid())
  slug                     String                   @unique(map: "ValentineCard_slug_key")
  jobName                  String?
  title                    String
  openingText              String?
  greeting                 String?
  subtitle                 String?
  message                  String?                  @db.Text
  signer                   String?
  backgroundColor          String?                  @default("#FFF0F3")
  status                   String                   @default("active")
  disabledAt               DateTime?
  backgroundMusicYoutubeId String?
  backgroundMusicUrl       String?                  @db.Text
  swipeHintColor           String?                  @default("white")
  swipeHintText            String?                  @default("Swipe up")
  showGame                 Boolean                  @default(true)
  campaignName             String?                  @default("Valentine's")
  customerPhone            String?
  customerAddress          String?                  @db.Text
  note                     String?                  @db.Text
  createdAt                DateTime                 @default(now())
  updatedAt                DateTime                 @updatedAt
  valentinecardtoproduct   ValentineCardToProduct[]
  valentinememories        ValentineMemory[]
  valentinescores          ValentineScore[]

  @@map("valentinecard")
}

model ValentineMemory {
  id            String        @id @default(uuid())
  cardId        String
  type          String        @default("image")
  url           String        @db.Text
  caption       String?
  thumbnail     String?       @db.Text
  order         Int           @default(0)
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  valentineCard ValentineCard @relation(fields: [cardId], references: [id], onDelete: Cascade, map: "ValentineMemory_cardId_fkey")

  @@index([cardId], map: "ValentineMemory_cardId_fkey")
  @@map("valentinememory")
}

model ValentineScore {
  id            String        @id @default(uuid())
  cardId        String
  score         Int
  createdAt     DateTime      @default(now())
  name          String
  playerId      String
  valentineCard ValentineCard @relation(fields: [cardId], references: [id], onDelete: Cascade, map: "ValentineScore_cardId_fkey")

  @@index([cardId], map: "ValentineScore_cardId_fkey")
  @@index([playerId], map: "ValentineScore_playerId_idx")
  @@index([score], map: "ValentineScore_score_idx")
  @@map("valentinescore")
}
